{% extends "base.html" %}

{# SEO ARTICLE INFO #}
{% set ARTICLE_TITLE = article.title|striptags|escape %}
{% set ARTICLE_DESCRIPTION = article.summary|striptags|escape|truncate(150) %}

{% if article.image %}
{% set ARTICLE_IMAGE = SITEURL + article.image %}
{% elif OPEN_GRAPH_IMAGE %}
{% set ARTICLE_IMAGE = SITEURL + OPEN_GRAPH_IMAGE %}
{% else %}
{% set ARTICLE_IMAGE = None %}
{% endif %}
{# END SEO ARTICLE INFO #}

{% block styles %}
{{ super() }}
{% if article.ipython %}
<style media="screen">
pre {
    color: inherit;
}
.rendered_html table {
margin-left: auto;
margin-right: auto;
border: 1px solid black;
border-collapse: collapse;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
border: 1px solid black;
border-collapse: collapse;
margin: 1em 2em;
}
.rendered_html td,
.rendered_html th {
text-align: left;
vertical-align: middle;
padding: 4px;
}
.rendered_html th {
font-weight: bold;
}
.rendered_html * + table {
margin-top: 1em;
}
</style>
{% else %}
<link href="/theme/css/pygments.css" type="text/css" rel="stylesheet" media="screen,projection"/>
{% endif %}
{% endblock %}

{% block seo %}
    <!-- OpenGraph -->
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="{{ ARTICLE_TITLE }}"/>
    <meta property="og:url" content="{{ SITEURL }}{{ article.url }}"/>
    <meta property="og:site_name" content="{{ SITENAME }}"/>
    <meta property="og:description" content="{{ ARTICLE_DESCRIPTION }}"/>
    {% if article.image %}
    <meta property="og:image" content="{{ ARTICLE_IMAGE }}"/>
    {% elif OPEN_GRAPH_IMAGE %}
    <meta property="og:image" content="{{ SITEURL }}{{ OPEN_GRAPH_IMAGE }}"/>
    {% endif %}

{% if TWITTER %}
    <!-- Twitter -->
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="{{ TWITTER }}"/>
    {% if article.author.name in MEMBROS and "twitter" in MEMBROS[article.author.name] %}
    <meta name="twitter:creator" content="{{ MEMBROS[article.author.name]["twitter"] }}"/>
    {% endif %}
    <meta name="twitter:domain" content="{{ SITEURL|replace("http://", "")|replace("https://", "") }}"/>
    <meta name="twitter:title" content="{{ ARTICLE_TITLE }}"/>
    <meta name="twitter:description" content="{{ ARTICLE_DESCRIPTION }}"/>
    {% if article.image %}
    <meta name="twitter:image:src" content="{{ ARTICLE_IMAGE }}"/>
    {% elif OPEN_GRAPH_IMAGE %}
    <meta name="twitter:image:src" content="{{ SITEURL }}{{ OPEN_GRAPH_IMAGE }}"/>
    {% endif %}
{% endif %}

    <!-- Article meta -->
    <meta property="article:author" content="{{ article.author }}"/>
    <meta property="article:section" content="{{ article.category }}"/>
    <meta property="article:tag" content="{{ article.tags|join(', ') }}"/>
    <meta property="article:published_time" content="{{ article.date.isoformat() }}"/>

    <!-- Google+ -->
    <meta itemprop="name" content="{{ ARTICLE_TITLE }}"/>
    <meta itemprop="description" content="{{ ARTICLE_DESCRIPTION }}"/>
    {% if article.image %}
    <meta itemprop="image" content="{{ ARTICLE_IMAGE }}"/>
    {% elif OPEN_GRAPH_IMAGE %}
    <meta itemprop="image" content="{{ SITEURL }}{{ OPEN_GRAPH_IMAGE }}"/>
    {% endif %}

    <!-- General purpose meta -->
    <meta name="description" content="{{ ARTICLE_DESCRIPTION }}"/>
    {% if article.tags %}
    <meta name="keywords" content="{{ article.tags|join(', ') }}"/>
    {% endif %}
{% endblock %}

{% block title %}{{ article.title }} | {{ SITENAME }}{% endblock %}

{% block content %}

{% set BREADCRUMB_ELEMENTS = [(article.category, article.category.url), (article.title, None)] %}
{% include "includes/breadcrumbs.html" %}
<article>
    {% set ARTICLE_BANNER = GET_ARTICLE_IMAGE(article, ARTICLE_BANNERS_FOLDER) %}
    {% if ARTICLE_BANNER %}
    <p>
        <img src="{{ SITEURL }}/{{ ARTICLE_BANNER }}" alt="" class="img-responsive" />
    </p>
    {% endif %}
    <a href="{{ article.url }}"><h3 class="ctitle">{{ article.title }}</h3></a>
    <p>
        Publicado em:  <time datetime="{{ article.date.isoformat() }}">{{ article.locale_date }}</time>.
        |
        Por: <a href="{{ article.author.url }}">{{ article.author.name }}</a>
        |
        Arquivado em: <a href="{{ article.category.url }}">{{ article.category.name }}</a>
    </p>
    {{ article.content }}
    <div class="hline"></div>
    <div class="spacing"></div>
    <p>
        {% for tag in article.tags %}
        <a class="btn btn-theme" href="{{ tag.url }}" role="button" title="Tag '{{ tag.name|escape }}'">{{ tag.name }}</a>
        {% endfor %}
    </p>
    <div class="spacing"></div>
    <h6>COMPARTILHAR:</h6>
    <p class="share">
		<a target="_blank" href="https://twitter.com/home?status={{ article.title|urlencode }}%20{{ SITEURL|urlencode }}{{ article.url|urlencode }}"><i class="fa fa-twitter"></i></a>
		<a href="https://www.facebook.com/sharer/sharer.php?u={{ SITEURL|urlencode }}{{ article.url|urlencode }}"><i class="fa fa-facebook"></i></a>
	</p>
</article>
{% if article.comments != "closed" %}
    {% include "includes/comments.html" %}
{% endif %}
{% endblock %}
